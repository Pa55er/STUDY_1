<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title></title>
        <style>
            * {
                padding: 0;
                margin: 0;
                box-sizing: border-box;
            }
            main {
                width: 80%;
                margin: 50px auto;
                border: 1px solid red;
            }
            h1 {
                text-align: center;
            }

            #signupFrom {
                border: 5px solid lightgray;
                font-size: 0.95rem;
            }
            #signupFrom > div {
                border: 1px solid lightcoral;
                margin-bottom: 1.5rem;
                display: flex;
                align-content: center;
                position: relative;
            }
            #signupFrom label {
                width: 100px;
                padding: 0.5rem;
            }
            #signupFrom input {
                flex: 1;
                background-color: aliceblue;
                padding: 0.5rem;
                outline: none;
                border: none;
                border-bottom: 1px solid lightblue;
            }
            #signupFrom input:focus {
                background-color: rgb(200, 228, 252);
            }

            #signupFrom p,
            .error {
                font-size: 0.7rem;
                position: absolute;
                padding-top: 5px;
            }
            #signupFrom p {
                border: 1px solid blue;
                right: 0;
            }
            .error {
                left: 100px;
                top: 100%;
                color: tomato;
            }
        </style>
    </head>
    <body>
        <main>
            <h1>회원가입</h1>
            <form id="signupFrom">
                <div>
                    <label for="name">회원이름</label>
                    <input type="text" id="name" required />
                    <span id="nameError" class="error"></span>
                </div>
                <div>
                    <label for="email">이메일</label>
                    <input type="email" id="email" required />
                    <span id="emailError" class="error"></span>
                </div>
                <div>
                    <label for="password">비밀번호:</label>
                    <input type="password" id="password" required />
                    <span id="passwordError" class="error"></span>
                </div>
                <div>
                    <label for="confirmPassword">비밀번호 확인:</label>
                    <input type="password" id="confirmPassword" required />
                    <span id="confirmPasswordError" class="error"></span>
                </div>
                <div>
                    <label for="phone">전화번호:</label>
                    <input type="tel" id="phone" required />
                    <span id="phoneError" class="error"></span>
                </div>
                <div>
                    <label for="address">주소:</label>
                    <input type="text" id="address" required />
                    <span id="addressError" class="error"></span>
                </div>

                <button type="submit">회원가입하기</button>
            </form>
        </main>

        <script>
            const form = document.querySelector("#signupFrom");
            const inputs = form.querySelectorAll("input");

            //   // 정규표현식 패턴정보  {name : 정규표현식 , email: , password:, phone:, adress: }
            //   // 오류메시지 리스트 { name : '한글로 작성', .................................}

            const patterns = {
                name: /^[가-힣]{2,4}$/,
                email: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
                password:
                    /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*]).{8,}$/,
                phone: /^01[016789]-\d{3,4}-\d{4}$/,
                address: /^.{10,}$/,
            };

            const errorMessages = {
                name: "이름은 2~4자의 한글이어야 합니다.",
                email: "올바른 이메일 형식이 아닙니다.",
                password:
                    "비밀번호는 8자 이상이며, 숫자, 소문자, 대문자, 특수문자를 포함해야 합니다.",
                confirmPassword: "비밀번호가 일치하지 않습니다.",
                phone: "올바른 전화번호 형식이 아닙니다. (예: 010-1234-5678)",
                address: "주소는 10자 이상이어야 합니다.",
            };

            const validateInput = (input) => {
                const errorElement = document.getElementById(
                    input.id + "Error"
                );
                let isValid = true;

                if (input.id === "confirmPassword") {
                    isValid =
                        input.value ===
                        document.getElementById("password").value;
                } else if (patterns[input.id]) {
                    isValid = patterns[input.id].test(input.value);
                }

                !isValid
                    ? (errorElement.textContent = errorMessages[input.id])
                    : (errorElement.textContent = "");

                return isValid;
            };

            const validateForm = () => {
                let isValid = true;
                inputs.forEach((input) => {
                    if (!validateInput(input)) {
                        isValid = false;
                    }
                });
                return isValid;
            };

            inputs.forEach((input) => {
                input.addEventListener("input", function () {
                    validateInput(this);
                });
            });

            form.addEventListener("submit", function (e) {
                e.preventDefault();
                if (validateForm()) {
                    alert("회원가입 완료 후 로그인 페이지로 이동");
                    form.reset();
                }
            });

            // $name.addEventListener("input", (e) => {
            //     const inputValue = e.target.value;
            //     const $nameError = document.querySelector("#nameError");
            //     $nameError.textContent = regexName.test(inputValue)
            //         ? ""
            //         : "한글만됨";
            //     document.querySelector(".log1").innerHTML = inputValue;
            // });
            // $email.addEventListener("input", (e) => {
            //     const inputValue = e.target.value;
            //     const $emailError = document.querySelector("#emailError");
            //     $emailError.textContent = regexEmail.test(inputValue)
            //         ? ""
            //         : "이메일 형식을 지켜주세요";
            //     document.querySelector(".log2").innerHTML = inputValue;
            // });

            // for (const property in errorMessages) {
            //     document
            //         .querySelector(`#${property}`)
            //         .addEventListener("input", (e) => {
            //             const inputValue = e.target.value;
            //             if (property === "confirmPassword") {
            //                 document.querySelector(
            //                     `#${property}Error`
            //                 ).textContent =
            //                     inputValue ===
            //                     document.querySelector("#password").value
            //                         ? ""
            //                         : errorMessages[property];
            //             } else {
            //                 document.querySelector(
            //                     `#${property}Error`
            //                 ).textContent = patterns[property].test(inputValue)
            //                     ? ""
            //                     : errorMessages[property];
            //             }
            //         });
            // }

            // $signupFrom.addEventListener("submit", (e) => {
            //     let count = 0;
            //     for (const property in errorMessages) {
            //         const inputValue = document.querySelector(
            //             `#${property}`
            //         ).value;
            //         if (property === "confirmPassword") {
            //             if (
            //                 inputValue ===
            //                 document.querySelector("#password").value
            //             )
            //                 count++;
            //         } else {
            //             if (patterns[property].test(inputValue)) count++;
            //         }
            //     }
            //     if (count !== 6) e.preventDefault();
            // });
        </script>
    </body>
</html>
